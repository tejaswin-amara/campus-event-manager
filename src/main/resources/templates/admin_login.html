<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - CampusConnect</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css?v=3}">
    <link rel="icon" type="image/svg+xml" th:href="@{/favicon.svg}">
    <script th:src="@{/js/main.js}" defer></script>
</head>

<body>
    <!-- Hidden inputs for Premium Toast Notifications -->
    <input type="hidden" id="flashSuccessMsg" th:value="${success}">
    <input type="hidden" id="flashErrorMsg" th:value="${error}">

    <!-- Particles Background -->
    <canvas id="particleCanvas"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;"></canvas>

    <div class="d-flex align-items-center justify-content-center min-vh-100 px-3">
        <div class="glass-card w-100 animate-in" style="max-width: 400px; padding: 2.5rem;">

            <!-- Logo / Icon -->
            <div class="text-center mb-4">
                <img th:src="@{/images/logo.png}" alt="CampusConnect" class="brand-logo-lg">
                <h3 class="fw-bold text-white mb-1">Admin Access</h3>
                <p class="text-muted small">Welcome back, please login</p>
            </div>

            <form th:action="@{/admin/login}" method="post">
                <!-- Static alert removed to use Premium Toasts -->

                <!-- Username -->
                <div class="mb-3">
                    <label for="username" class="form-label small text-muted fw-bold text-uppercase">Username</label>
                    <div class="input-group">
                        <span class="input-group-text bg-transparent border-end-0 text-muted"
                            style="border-color: var(--border-glass);">
                            <i class="bi bi-person"></i>
                        </span>
                        <input type="text" class="form-control border-start-0 ps-0" id="username" name="username"
                            placeholder="Enter username" required
                            style="background: rgba(255,255,255,0.03); border-color: var(--border-glass); color: white;">
                    </div>
                </div>

                <!-- Password -->
                <div class="mb-4">
                    <label for="password"
                        class="form-label small text-muted fw-bold text-uppercase d-flex justify-content-between">
                        Password
                    </label>
                    <div class="input-group">
                        <span class="input-group-text bg-transparent border-end-0 text-muted"
                            style="border-color: var(--border-glass);">
                            <i class="bi bi-lock"></i>
                        </span>
                        <input type="password" class="form-control border-start-0 border-end-0 ps-0" id="password"
                            name="password" placeholder="Enter password" required
                            style="background: rgba(255,255,255,0.03); border-color: var(--border-glass); color: white;">
                        <span class="input-group-text bg-transparent border-start-0 text-muted cursor-pointer"
                            style="border-color: var(--border-glass); cursor: pointer;" onclick="togglePassword()">
                            <i class="bi bi-eye" id="toggleIcon"></i>
                        </span>
                    </div>
                </div>

                <!-- Submit -->
                <button type="submit" class="btn-action w-100 justify-content-center shadow-lg mb-4">
                    Sign In <i class="bi bi-arrow-right-short ms-1"></i>
                </button>

                <!-- Back Link -->
                <div class="text-center">
                    <a th:href="@{/}" class="text-muted text-decoration-none small hover-white opacity-75">
                        <i class="bi bi-arrow-left me-1"></i> Back to Student Portal
                    </a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Toggle Password Visibility
        function togglePassword() {
            const input = document.getElementById('password');
            const icon = document.getElementById('toggleIcon');
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.replace('bi-eye', 'bi-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.replace('bi-eye-slash', 'bi-eye');
            }
        }

        // Particle Animation (Subtler)
        (function () {
            const canvas = document.getElementById('particleCanvas');
            const ctx = canvas.getContext('2d');
            let particles = [];
            const count = 40; // Reduced count

            function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
            window.addEventListener('resize', resize);
            resize();

            for (let i = 0; i < count; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 0.3,
                    vy: (Math.random() - 0.5) * 0.3,
                    s: Math.random() * 2 // Smaller particles
                });
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = 'rgba(99, 102, 241, 0.3)'; // Dimmer
                particles.forEach(p => {
                    p.x += p.vx; p.y += p.vy;
                    if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.s, 0, Math.PI * 2);
                    ctx.fill();
                });
                requestAnimationFrame(animate);
            }
            animate();
        })();
    </script>
</body>

</html>